CREATE TABLE IF NOT EXISTS batches_uploads
(
    id               INT8 NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    batch_owner_name VARCHAR(20),
    uploaded_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    submitted_at     TIMESTAMP,
    total_records    INT       DEFAULT 0,
    valid_records    INT       DEFAULT 0,
    invalid_records  INT       DEFAULT 0,
    status           VARCHAR(20),
    finish_at        TIMESTAMP
);

CREATE INDEX IF NOT EXISTS idx_batches_uploads_status ON batches_uploads (status);

CREATE TABLE IF NOT EXISTS batches_uploads_staging
(
    id              INT8 NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    batch_upload_id INT8 NOT NULL,
    customer_code   TEXT,
    invoice_date    DATE,
    due_amount      DECIMAL(40, 20),
    currency        VARCHAR(5),
    remark          TEXT,
    is_valid        BOOLEAN,
    created_at      TIMESTAMP
);
CREATE INDEX IF NOT EXISTS idx_batches_uploads_staging_customer_code ON batches_uploads_staging (customer_code);

CREATE TABLE IF NOT EXISTS batches_uploads_prod
(
    id              INT8 NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    batch_upload_id INT8 NOT NULL,
    customer_code   TEXT,
    invoice_date    DATE,
    due_amount      DECIMAL(40, 20),
    currency        VARCHAR(5),
    remark          TEXT,
    is_valid        BOOLEAN,
    created_at      TIMESTAMP
);
CREATE INDEX IF NOT EXISTS idx_batches_uploads_staging_customer_code ON batches_uploads_staging (customer_code);
